#!/usr/bin/env ruby

require_relative '../lib/mya'

args = ARGV.dup
dump_jit = args.delete('--dump-jit')
jit = args.delete('--jit') || dump_jit

code = if args.first == '-e'
         args[1]
       else
         File.read(args.first)
       end

instructions = Compiler.new(code).compile

if jit
  p JIT.new(instructions, dump_jit:).run
else
  p VM.new(instructions).run
end
